#+title: с использованием оператора GROUP BY

1. Назначение запроса: таблица людей с потраченной ими суммой на заказы

#+BEGIN_SRC sql

# 2022-11-09 00:46:11.872778
select `Floor`, COUNT(*) from `Room` group by `Floor`;
+-------+----------+
| Floor | COUNT(*) |
+-------+----------+
| 1     | 4        |
| 2     | 5        |
| 3     | 5        |
| 4     | 4        |
| 5     | 1        |
| 6     | 1        |
+-------+----------+
6 rows in set
Time: 0.034s

#+END_SRC

2. Назначение запроса: получить список людей, которые заказывали vip номера со стоимостью их заказов

#+BEGIN_SRC sql

# 2022-11-09 00:47:12.761050
select `Floor`, COUNT(*) as `number of rooms` from `Room` group by `Floor`;
+-------+-----------------+
| Floor | number of rooms |
+-------+-----------------+
| 1     | 4               |
| 2     | 5               |
| 3     | 5               |
| 4     | 4               |
| 5     | 1               |
| 6     | 1               |
+-------+-----------------+
6 rows in set
Time: 0.028s

# 2022-11-09 00:49:17.065858
select `People`.`Age`, count(*) from `People` group by `People`.`Age`;
+-----+----------+
| Age | count(*) |
+-----+----------+
| 56  | 1        |
| 90  | 1        |
| 47  | 2        |
| 42  | 1        |
| 4   | 1        |
| 22  | 1        |
| 28  | 1        |
| 86  | 1        |
| 8   | 1        |
| 64  | 1        |
| 65  | 1        |
| 79  | 1        |
| 62  | 1        |
| 10  | 1        |
| 1   | 1        |
| 66  | 1        |
| 75  | 1        |
| 20  | 1        |
| 91  | 1        |
+-----+----------+
19 rows in set
Time: 0.014s

# 2022-11-09 00:49:26.699273
select `People`.`Age`, count(*) from `People` group by `People`.`Age` order by `Age`;
+-----+----------+
| Age | count(*) |
+-----+----------+
| 1   | 1        |
| 4   | 1        |
| 8   | 1        |
| 10  | 1        |
| 20  | 1        |
| 22  | 1        |
| 28  | 1        |
| 42  | 1        |
| 47  | 2        |
| 56  | 1        |
| 62  | 1        |
| 64  | 1        |
| 65  | 1        |
| 66  | 1        |
| 75  | 1        |
| 79  | 1        |
| 86  | 1        |
| 90  | 1        |
| 91  | 1        |
+-----+----------+
19 rows in set
Time: 0.015s

# 2022-11-09 00:54:51.382907
select r.`Class`, avg(h.`Price`) as `avg price` from
`HotelOrder` h inner join `Room` r using(room_id)
group by r.`Class`;
+----------+-------------+
| Class    | avg price   |
+----------+-------------+
| standart | 232165.0000 |
| half vip | 287194.2222 |
| vip      | 479318.0000 |
+----------+-------------+
3 rows in set
Time: 0.017s

# 2022-11-09 00:55:14.988801
quit;
Goodbye!

#+END_SRC
